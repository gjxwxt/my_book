![cover_image](https://mmbiz.qpic.cn/sz_mmbiz_jpg/TpB2QHJbiaicGYCJGZT4uj3E0IiaRMnAYkdWIq0DWKnfibRdew2scicYeYoLHgu56X6h8E4gtNr6OibW4gAba3lib6DXg/0?wx_fmt=jpeg)

#  é’‰é’‰å°ç¨‹åºå®ç°ç­¾åæ¿

åŸåˆ›  ç‹è€€  [ Goodmeå‰ç«¯å›¢é˜Ÿ ](javascript:void\(0\);)

__ _ _ _ _

![](https://mmbiz.qpic.cn/sz_mmbiz_png/TpB2QHJbiaicGYCJGZT4uj3E0IiaRMnAYkdUwk7B0o3FTsVu3icIic8CGppz0GNG17IgibpZjNicAhzSdiakf79OA7ZIKg/640?wx_fmt=png&from=appmsg)  

##  å‰è¨€

å¤èŒ—ç›®å‰å·²ç»æœ‰è¿‘ä¸‡å®¶é—¨åº—äº†ï¼Œä¸ºäº†å¯¹é—¨åº—åšè§„èŒƒç®¡ç†ï¼Œä¼šè¿›è¡Œå·¡åº—ä¸”è¾“å‡ºå·¡åº—æŠ¥å‘Šï¼Œæ­¤æ—¶å°±éœ€è¦æœ‰ä¸€ä¸ªè€æ¿ç­¾åçš„åŠŸèƒ½ï¼Œè¯æ˜è€æ¿è®¤å¯ä¸”äº†è§£å½“å‰ç»“æœã€‚ç”±äºæˆ‘ä»¬å·¡åº—ç”¨åˆ°çš„æ˜¯é’‰é’‰å°ç¨‹åºï¼Œæ‰€ä»¥ä¸‹é¢å°†ä¼šä¸ºå¤§å®¶å±•ç¤ºå¦‚ä½•åœ¨å°ç¨‹åºä¸­å®ç°ä¸€ä¸ªç­¾åæ¿åŠŸèƒ½ã€‚

![](https://mmbiz.qpic.cn/sz_mmbiz_gif/TpB2QHJbiaicGYCJGZT4uj3E0IiaRMnAYkdG2x8S1yb9SH7briaMh9kkfia5iaxytNPQLkibfzomN9iauewiaia1HrV5v4ZQ/640?wx_fmt=gif&from=appmsg)
ç­¾åæ•ˆæœ

##  è®¾è®¡å®ç°

ä¸ºäº†å®ç°ç­¾ååŠŸèƒ½ï¼Œéœ€è¦ç”¨åˆ° canvasï¼Œæˆ‘ä»¬ç¿»é˜…é’‰é’‰ api æ–‡æ¡£ï¼Œå‘ç°æ”¯æŒ ` Canvas ` ç»„ä»¶ï¼Œvery
niceï¼Œä¸‹é¢å¼€å§‹å®ç°ã€‚ï¼ˆç”±äºæˆ‘ä»¬å†…éƒ¨ä½¿ç”¨ taro æ¡†æ¶ï¼Œä»¥ä¸‹ä»£ç å‡ä¸º taro + reactï¼Œæˆ‘ä»¬è®¾è®¡ç¨¿å‡ä¸º 750ï¼Œæ‰€ä»¥æ ·å¼ä¸­æ•°å€¼å‡æ˜¯å®é™…çš„2å€ï¼‰

###  åˆ›å»ºcanvas

æˆ‘ä»¬å…ˆåœ¨é¡µé¢ä¸­åˆ›å»ºä¸€ä¸ªcanvasç”»å¸ƒ

    
    
    //Â SignaturePad.jsx  
    importÂ {Â CanvasÂ }Â fromÂ '@tarojs/components';  
      
    constÂ SignaturePadÂ =Â ()Â =>Â {  
    Â Â returnÂ (  
    Â Â Â Â <Canvas  
    Â Â Â Â Â Â id="signature"  
    Â Â Â Â Â Â canvasId="signature"  
    Â Â Â Â Â Â className="canvas"  
    Â Â Â Â Â Â width="343"  
    Â Â Â Â Â Â height="180"  
    Â Â Â Â Â Â />  
    Â Â )  
    }  
      
    Â Â //Â SignaturePad.less  
    .canvasÂ {  
    Â Â background:Â #fff;  
    }  
    

![](https://mmbiz.qpic.cn/sz_mmbiz_png/TpB2QHJbiaicGYCJGZT4uj3E0IiaRMnAYkd7j2uhkx9l1h3PNibMzdf1EWKxCjib5ESDgtxJFdq1icY6jhwkmYzQMOWA/640?wx_fmt=png&from=appmsg)
1705740633476.png

æ­¤æ—¶ä¼šå‘ç”Ÿä¸€ä¸ªç¥å¥‡çš„ç°è±¡ï¼Œæ˜æ˜è®¾ç½®äº† width=343 å’Œ height=180ï¼Œæ€ä¹ˆè¿˜æ˜¯é’‰é’‰é»˜è®¤çš„ 300x225 ï¼Ÿåˆ«æ€¥ï¼Œæˆ‘ä»¬å¾€ä¸‹èµ°ã€‚

###  è°ƒæ•´ç”»å¸ƒ

ä¸ºäº†å¾—åˆ°æ­£ç¡®çš„å±•ç¤ºå¤§å°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®æ ·å¼å®ç°

    
    
    //Â SignaturePad.less  
    .canvasÂ {  
    Â Â background:Â #fff;  
    Â Â width:Â 100%;  
    Â Â height:Â 360px;  
    }  
    

![](https://mmbiz.qpic.cn/sz_mmbiz_png/TpB2QHJbiaicGYCJGZT4uj3E0IiaRMnAYkdwNxfJicmicEIBUeR2HpnTiaqaqvL9RBEmSIjejECCum2cufueQIXrUpXA/640?wx_fmt=png&from=appmsg)
1705741273750.png

ç¡®å®æ˜¯èµ·æ•ˆäº†ï¼Œé‚£ä¹ˆè®¾ç½® ` width ` å’Œ ` height `
å±æ€§æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Œæˆ‘ä»¬çœ‹ä¸‹é’‰é’‰æ–‡æ¡£ï¼Œå¯ä»¥å‘ç°è¿™ä¸¤ä¸ªå±æ€§å¯ä»¥ç”¨æ¥æ§åˆ¶ç»˜ç”»ç²¾ç»†åº¦ï¼Œè§£å†³åœ¨é«˜dprçš„æƒ…å†µä¸‹é€ æˆçš„ç»˜ç”»æ¨¡ç³Šé—®é¢˜ã€‚

![](https://mmbiz.qpic.cn/sz_mmbiz_png/TpB2QHJbiaicGYCJGZT4uj3E0IiaRMnAYkdsBiarnvHTB2jVO3GK2S95M8q1SZfq7WVnsuY5nsnye9O65jcCAN7HLQ/640?wx_fmt=png&from=appmsg)
1705741420270.png

è¿™é‡Œè¿˜éœ€è¦æ³¨æ„ï¼Œå®½é«˜å±æ€§éœ€è¦å’Œcssä¸­å®½é«˜å±æ€§ä¿æŒç›¸åŒæ¯”ä¾‹ï¼Œå¦åˆ™ç»˜ç”»ä¼šå‡ºç°æ‰­æ›²æƒ…å†µ

###  åˆå§‹åŒ–

ç”»å¸ƒåˆ›å»ºå®Œæˆäº†ï¼Œæ¥ä¸‹æ¥éœ€è¦å®ç°ç”»ç¬”åŠŸèƒ½ï¼Œè¿™æ—¶å€™å°±éœ€è¦ç»“åˆ ` CanvasContext ` ç»˜å›¾ä¸Šä¸‹æ–‡å¯¹è±¡é¢„è®¾ç”»ç¬”å±æ€§ä»¥åŠåç»­ç»˜å›¾éœ€è¦ç”¨åˆ°çš„åæ ‡è½´

    
    
    //Â SignaturePad.jsx  
    letÂ ctxÂ =Â null;  
    letÂ startXÂ =Â 0;  
    letÂ startYÂ =Â 0;  
      
    constÂ SignaturePadÂ =Â ()Â =>Â {  
    Â constÂ initCanvasÂ =Â ()Â =>Â {  
    Â Â Â Â //Â åˆ›å»ºÂ canvasÂ çš„ç»˜å›¾ä¸Šä¸‹æ–‡Â CanvasContextÂ å¯¹è±¡  
    Â Â Â Â ctxÂ =Â Taro.createCanvasContext('signature');  
    Â Â Â Â //Â è®¾ç½®æè¾¹é¢œè‰²  
    Â Â Â Â ctx.setStrokeStyle('#000000');  
    Â Â Â Â //Â è®¾ç½®çº¿æ¡çš„å®½åº¦  
    Â Â Â Â ctx.setLineWidth(4);  
    Â Â Â Â //Â è®¾ç½®çº¿æ¡çš„ç«¯ç‚¹æ ·å¼  
    Â Â Â Â ctx.setLineCap('round');  
    Â Â Â Â //Â è®¾ç½®çº¿æ¡çš„äº¤ç‚¹æ ·å¼  
    Â Â Â Â ctx.setLineJoin('round');  
    Â Â };  
      
    Â Â useEffect(()Â =>Â {  
    Â Â Â Â initCanvas();  
    Â Â Â Â returnÂ ()Â =>Â {  
    Â Â Â Â Â Â ctxÂ =Â null;  
    Â Â Â Â };  
    Â Â },Â []);  
      
    Â Â ...  
    }  
    

###  ç»˜ç”»

æ‰€æœ‰å‡†å¤‡å·¥ä½œå®Œæˆï¼Œç„¶åå°±æ˜¯å¦‚ä½•å®ç°ç»˜ç”»åŠŸèƒ½äº†ã€‚æƒ³è¦å®ç°ç»˜ç”»ï¼Œè¦å¯¹ canvas æœ‰æ‰€äº†è§£ï¼Œcanvas å…ƒç´ é»˜è®¤è¢«ç½‘æ ¼æ‰€è¦†ç›–ã€‚é€šå¸¸æ¥è¯´ç½‘æ ¼ä¸­çš„ä¸€ä¸ªå•å…ƒç›¸å½“äº
canvas å…ƒç´ ä¸­çš„ä¸€åƒç´ ã€‚æ …æ ¼çš„èµ·ç‚¹ä¸ºå·¦ä¸Šè§’ï¼Œåæ ‡ä¸º (0,0) ã€‚æ‰€æœ‰å…ƒç´ çš„ä½ç½®éƒ½ç›¸å¯¹äºåŸç‚¹æ¥å®šä½ã€‚æ‰€ä»¥å›¾ä¸­è“è‰²æ–¹å½¢å·¦ä¸Šè§’çš„åæ ‡ä¸ºè·ç¦»å·¦è¾¹ï¼ˆX è½´ï¼‰x
åƒç´ ï¼Œè·ç¦»ä¸Šè¾¹ï¼ˆY è½´ï¼‰y åƒç´ ï¼Œåæ ‡ä¸º (x, y)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/TpB2QHJbiaicGYCJGZT4uj3E0IiaRMnAYkdz5WR4qo3xY9N0JSIDGvv2ibDLNOrLT5ngrNBpASwGwib4Ro7LMu0SOlw/640?wx_fmt=png&from=appmsg)
Canvas_default_grid.png

Canvasç›¸å…³å±æ€§

![](https://mmbiz.qpic.cn/sz_mmbiz_png/TpB2QHJbiaicGYCJGZT4uj3E0IiaRMnAYkdiboq8Gpw8ZOh824kdFibSnSmmhxVNaZ1tKjT7ztaiafgrzV3GXg2reUCQ/640?wx_fmt=png&from=appmsg)
image.png

äº†è§£äº†åŸºç¡€çŸ¥è¯†ï¼Œæˆ‘ä»¬å°±åŸºæœ¬çŸ¥é“å¦‚ä½•å®ç°äº†ã€‚é€šè¿‡ ` onTouchStart ` ç¡®å®šç”»ç¬”å¼€å§‹åæ ‡ï¼Œ ` onTouchMove `
è·å–ç”¨æˆ·åœ¨canvaså†…çš„ç»˜ç”»è·¯å¾„ï¼Œå°†è·¯å¾„ä¸Šæ‰€æœ‰çš„ç‚¹éƒ½å¡«å……ä¸Šé¢œè‰²ã€‚

    
    
    //Â æ˜¯å¦ç»˜ç”»è¿‡  
    constÂ isPaintÂ =Â useRef(false)  
      
    constÂ canvasStartÂ =Â (e)Â =>Â {  
    Â Â startXÂ =Â e.touches[0].x;  
    Â Â startYÂ =Â e.touches[0].y;  
    Â Â //Â å¼€å§‹åˆ›å»ºä¸€ä¸ªè·¯å¾„  
    Â Â ctx.beginPath();  
    };  
      
    constÂ canvasMoveÂ =Â (e)Â =>Â {  
    Â Â ifÂ (startXÂ !==Â 0Â &&Â !isPaint.current)Â {  
    Â Â Â Â isPaint.currentÂ =Â true;  
    Â Â }  
    Â Â constÂ {Â x,Â yÂ }Â =Â e.touches[0];  
    Â Â //Â æŠŠè·¯å¾„ç§»åŠ¨åˆ°ç”»å¸ƒä¸­çš„æŒ‡å®šç‚¹ï¼Œä¸åˆ›å»ºçº¿æ¡  
    Â Â ctx.moveTo(startX,Â startY);  
    Â Â //Â å¢åŠ ä¸€ä¸ªæ–°ç‚¹ï¼Œç„¶ååˆ›å»ºä¸€æ¡ä»ä¸Šæ¬¡æŒ‡å®šç‚¹åˆ°ç›®æ ‡ç‚¹çš„çº¿  
    Â Â ctx.lineTo(x,Â y);  
    Â Â //Â ç”»å‡ºå½“å‰è·¯å¾„çš„è¾¹æ¡†  
    Â Â ctx.stroke();  
    Â Â //Â å°†ä¹‹å‰åœ¨ç»˜å›¾ä¸Šä¸‹æ–‡ä¸­çš„æè¿°ï¼ˆè·¯å¾„ã€å˜å½¢ã€æ ·å¼ï¼‰ç”»åˆ°Â canvasÂ ä¸­  
    Â Â ctx.draw(true);  
    Â Â startXÂ =Â x;  
    Â Â startYÂ =Â y;  
    };  
      
    constÂ canvasEndÂ =Â ()Â =>Â {  
    Â ctx.closePath();  
    };  
      
    returnÂ (  
    Â Â <Canvas  
    Â Â Â Â id="signature"  
    Â Â Â Â canvasId="signature"  
    Â Â Â Â className="canvas"  
    Â Â Â Â onTouchStart={canvasStart}  
    Â Â Â Â onTouchMove={canvasMove}  
    Â Â Â Â onTouchEnd={canvasEnd}  
    Â Â Â Â onTouchCancel={canvasEnd}  
    Â Â Â Â width="343"  
    Â Â Â Â height="180"  
    Â Â Â Â disableScrollÂ //Â ç¦æ­¢å±å¹•æ»šåŠ¨ä»¥åŠä¸‹æ‹‰åˆ·æ–°  
    Â Â />  
    )  
    

###  æ·»åŠ æ“ä½œ

åˆ°è¿™é‡Œï¼ŒåŸºç¡€çš„ç»˜ç”»å·²ç»å®Œæˆäº†ï¼Œä½†æ˜¯æˆ‘ä»¬æ˜¯éœ€è¦å°†ç”Ÿæˆçš„ç­¾åä¿å­˜åˆ°æœåŠ¡ç«¯çš„ï¼Œæ‰€ä»¥è¿˜éœ€è¦æœ‰ä¸€ä¸ªç¡®å®šæ“ä½œã€‚

    
    
    constÂ createImgÂ =Â asyncÂ ()Â =>Â {  
    Â Â ifÂ (!isPaint.current)Â {  
    Â Â Â Â Taro.showToast({  
    Â Â Â Â Â Â title:Â 'ç­¾åå†…å®¹ä¸èƒ½ä¸ºç©ºï¼',  
    Â Â Â Â Â Â icon:Â 'none',  
    Â Â Â Â });  
    Â Â Â Â returnÂ false;  
    Â Â }  
    Â Â //Â æŠŠç”»å¸ƒå†…å®¹å¯¼å‡ºæˆå›¾ç‰‡ï¼Œè¿”å›æ–‡ä»¶è·¯å¾„  
    Â Â constÂ {Â filePathÂ }Â =Â awaitÂ ctx.toTempFilePath();  
    Â Â //Â è¿™é‡Œå°±å¯ä»¥åšæ‹¿åˆ°è·¯å¾„çš„åç»­æ“ä½œäº†  
    Â Â //Â ...  
    };  
    

æœ‰äº†ç¡®å®šæ“ä½œï¼Œå‡å¦‚ç”¨æˆ·ç­¾é”™åå­—äº†æƒ³è¦é‡å†™ï¼Œè¿˜éœ€è¦ä¸€ä¸ªæ¸…é™¤æ“ä½œã€‚

    
    
    letÂ canvaswÂ =Â 0;  
    letÂ canvashÂ =Â 0;  
      
    //Â è·å–Â canvasÂ çš„å°ºå¯¸ï¼ˆå®½é«˜ï¼‰  
    constÂ getCanvasSizeÂ =Â ()Â =>Â {  
    Â Â nextTick(()Â =>Â {  
    Â Â Â Â //Â å°ç¨‹åºæŸ¥è¯¢èŠ‚ç‚¹ä¿¡æ¯æ–¹æ³•  
    Â Â Â Â constÂ queryÂ =Â Taro.createSelectorQuery();  
    Â Â Â Â query  
    Â Â Â Â Â Â .select('#signature')  
    Â Â Â Â Â Â .boundingClientRect()  
    Â Â Â Â Â Â .exec(([rect])Â =>Â {  
    Â Â Â Â Â Â Â Â canvaswÂ =Â rect.width;  
    Â Â Â Â Â Â Â Â canvashÂ =Â rect.height;  
    Â Â Â Â Â Â });  
    Â Â });  
    };  
      
    useEffect(()Â =>Â {  
    Â Â getCanvasSize();  
    Â Â ...  
    },Â []);  
      
    constÂ clearDrawÂ =Â ()Â =>Â {  
    Â Â startXÂ =Â 0;  
    Â Â startYÂ =Â 0;  
    Â Â //Â æ¸…é™¤ç”»å¸ƒä¸Šåœ¨è¯¥çŸ©å½¢åŒºåŸŸå†…çš„å†…å®¹  
    Â Â ctx.clearRect(0,Â 0,Â canvasw,Â canvash);  
    Â Â ctx.draw(true);  
    Â Â setIsPaint(false);  
    };  
    

![](https://mmbiz.qpic.cn/sz_mmbiz_gif/TpB2QHJbiaicGYCJGZT4uj3E0IiaRMnAYkdorY1ph6wMx3tdiaAyFMMdXUVroAfEm4hXP9wfvnwIyueYGjfxw2UGtg/640?wx_fmt=gif&from=appmsg)  
åˆ°è¿™é‡Œï¼Œä¸€ä¸ªåŸºç¡€çš„ç­¾åæ¿å·²ç»å®Œæˆäº†ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€äº›å¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹ï¼Œä¸‹é¢æˆ‘ä»¬å°†ç»§ç»­å¯¹å®ƒè¿›è¡Œä¸€äº›ä¼˜åŒ–ã€‚

##  ä¼˜åŒ–

###  æ’¤å›

æ¸…ç©ºè™½ç„¶èƒ½è§£å†³ç”¨æˆ·å†™é”™çš„é—®é¢˜ï¼Œä½†æ˜¯åªæ’¤å›ä¸Šä¸€ç¬”å¯¹ç”¨æˆ·ä½“éªŒæ¥è¯´æ˜¯æ›´å¥½çš„ã€‚æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ª ` history ` ç”¨äºè®°å½•ç”¨æˆ·æ¯ä¸€æ¬¡ç»˜ç”»ï¼Œç„¶åé€šè¿‡ `
getImageData ` è·å–canvasåŒºåŸŸéšå«çš„åƒç´ æ•°æ®ï¼Œå°†å…¶ ` push() ` åˆ° ` history `
ä¸­ï¼Œåœ¨è§¦å‘æ’¤å›æ“ä½œæ—¶ï¼Œå°†æœ€æ–°ä¸€æ¡æ•°æ® ` pop() ` åŒæ—¶æ¸…ç©ºç”»å¸ƒï¼Œå†é€šè¿‡ ` putImageData ` å°† ` history `
æœ€åä¸€æ¡åƒç´ æ•°æ®ç»˜åˆ¶åˆ°ç”»å¸ƒä¸Šï¼Œè¿™æ ·å°±èƒ½å®ç°æ’¤å›æ•ˆæœã€‚

    
    
    constÂ historyÂ =Â useRef([]);  
      
    constÂ canvasEndÂ =Â asyncÂ ()Â =>Â {  
    Â Â ctx.closePath();  
    Â Â constÂ resÂ =Â awaitÂ ctx.getImageData({Â x:Â 0,Â y:Â 0,Â width:Â canvasw,Â height:Â canvashÂ });  
    Â Â history.current.push(res);  
    };  
      
    //Â æ’¤å›  
    constÂ revokeÂ =Â ()Â =>Â {  
    Â Â ifÂ (!history.current.length)Â return;  
    Â Â history.current.pop();  
    Â Â ifÂ (!history.current.length)Â {  
    Â Â Â Â ctx.clearRect(0,Â 0,Â canvasw,Â canvash);  
    Â Â Â Â ctx.draw(true);  
    Â Â Â Â return;  
    Â Â }  
    Â Â ctx.putImageData(history.current[history.current.lengthÂ -Â 1]);  
    };  
    

![](https://mmbiz.qpic.cn/sz_mmbiz_gif/TpB2QHJbiaicGYCJGZT4uj3E0IiaRMnAYkdxNJGiaIgwlNnT2BlU0Lk0K2Wic3FATmTceIQroUCWpsk3afyVPH3341A/640?wx_fmt=gif&from=appmsg)
ç­¾å-3.gif

###  æ¨ªå±

ç«–å±æ—¶ç­¾å­—åŒºåŸŸç›¸å¯¹è¾ƒå°ï¼Œåªè¦å°†å…¶åˆ‡åˆ°æ¨ªå±é‚£ä¹ˆä½“éªŒå°†ä¼šå¥½éå¸¸å¤šäº†ã€‚æŸ¥é˜…é’‰é’‰æ–‡æ¡£ï¼Œå‘ç°å¹¶æ²¡æœ‰æä¾›å°ç¨‹åºåˆ‡æ¢æ¨ªç«–å±çš„apiï¼Œé‚£ä¹ˆåªèƒ½æˆ‘ä»¬è‡ªå·±åšä¸€ä¸ªæ¨ªå±æ•ˆæœäº†ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡
` rotate ` å’Œ ` translate ` æ ·å¼ï¼Œå°†ç­¾åç‰ˆæ¨ªç½®ï¼Œå†å¯¹å…¶è°ƒæ•´å®½é«˜ã€‚

    
    
    //Â SignaturePad.jsx  
    constÂ [full,Â setFull]Â =Â useState(false);  
      
    constÂ toggleSizeÂ =Â ()Â =>Â {  
    Â Â setFull(!full);  
    };  
      
    returnÂ (  
    Â Â <ViewÂ className="signature-pad-wrap">  
    Â Â Â Â <ViewÂ className={`signature-padÂ ${fullÂ ?Â 'full-screen'Â :Â ''}`}>  
    Â Â Â Â Â Â {/*Â canvasÂ */}  
    Â Â Â Â Â Â ...  
    Â Â Â Â </View>  
    Â Â </View>  
    )  
      
    //Â SignaturePad.less  
    .signature-padÂ {  
    Â Â box-sizing:Â border-box;  
    Â Â width:Â 100%;  
    Â Â padding:Â 32pxÂ 32pxÂ 30px;  
    Â Â transform-origin:Â topÂ left;  
    Â Â transition:Â transformÂ 0.3s;  
      
    Â Â .canvasÂ {  
    Â Â Â Â width:Â 686px;  
    Â Â Â Â height:Â 360px;  
    Â Â Â Â background:Â #fff;  
    Â Â }  
      
    Â Â &.full-screenÂ {  
    Â Â Â Â width:Â 100vh;  
    Â Â Â Â height:Â 100vw;  
    Â Â Â Â transform:Â rotate(90deg)Â translate(0,Â -756px);  
      
    Â Â Â Â .canvasÂ {  
    Â Â Â Â Â Â width:Â 1386px;  
    Â Â Â Â Â Â height:Â 630px;  
    Â Â Â Â }  
    Â Â }  
    }  
    

![](https://mmbiz.qpic.cn/sz_mmbiz_gif/TpB2QHJbiaicGYCJGZT4uj3E0IiaRMnAYkdUoxy0lcw6Jt0HS68VFLxBc7Ck4fWtyjlgM4jqyz2YibENjLhHm9bjJQ/640?wx_fmt=gif&from=appmsg)
ç­¾å-4.gif

ç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°å¦‚å›¾æ•ˆæœï¼Œç­¾åç‰ˆæ˜¯æ¨ªç½®äº†ï¼Œä½†æ˜¯è¿™ä¸ªç­¾ååŠŸèƒ½æ˜æ˜¾ä¸å¯¹äº†ã€‚é€šè¿‡æ‰“å° ` onTouchMove ` çš„ ` event `
ï¼Œæˆ‘ä»¬å‘ç°xï¼Œyä¾ç„¶æ˜¯ ` (0, 0) `
ï¼Œå› ä¸ºå±å¹•çš„xyè½´ä¸ä¼šå˜ï¼Œä½†æ˜¯æˆ‘ä»¬æ—‹è½¬äº†æ•´ä¸ªç­¾åç‰ˆï¼Œæ‰€ä»¥å±•ç¤ºå‡ºçš„canvasçš„xyè½´æ˜¯è·Ÿéšç€å˜å½¢äº†ï¼Œå¯¼è‡´äº†ä¸Šå›¾æƒ…å†µã€‚

![](https://mmbiz.qpic.cn/sz_mmbiz_png/TpB2QHJbiaicGYCJGZT4uj3E0IiaRMnAYkds5jT4yZH57KpwFgYicpC72ovRKfyicticSWzRGUz3s5T3HjPBRLBoh7Cw/640?wx_fmt=png&from=appmsg)
![](https://mmbiz.qpic.cn/sz_mmbiz_png/TpB2QHJbiaicGYCJGZT4uj3E0IiaRMnAYkdI3u1XSUO193wicp3MPDicaqCqkY5oyibmv3ZIBE3icqlKbb0zf235UG47w/640?wx_fmt=png&from=appmsg)

æ—¢ç„¶canvasæ—‹è½¬ä¼šå¯¼è‡´xyè½´å˜åŒ–ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ¢ä¸ªè§’åº¦ï¼Œåªæ”¹å˜canvasçš„å®½é«˜ï¼Œå°†æ ‡é¢˜æŒ‰é’®åŒºåŸŸè¿›è¡Œ ` transform ` æ˜¯ä¸æ˜¯å°±å¯ä»¥äº†

    
    
    //Â SignaturePad.jsx  
    <ViewÂ className={`signature-padÂ ${fullÂ ?Â 'full-screen'Â :Â ''}`}>  
    Â Â <ViewÂ className="signature-top">  
    Â Â Â Â <ViewÂ className="title">ç­¾åæ¿</View>  
    Â Â Â Â {/*Â ä¸€ç³»åˆ—æŒ‰é’®Â */}  
    Â Â Â Â </View>  
    Â Â </View>  
    Â Â <Canvas  
    Â Â Â Â id="signature"  
    Â Â Â Â canvasId="signature"  
    Â Â Â Â className="canvas"  
    Â Â Â Â ...  
    Â Â />  
    </View>  
    Â Â Â Â Â Â Â Â Â Â   
    //Â SignaturePad.less  
    .signature-padÂ {  
    Â Â .signature-topÂ {  
    Â Â Â Â transform-origin:Â topÂ left;  
    Â Â Â Â transition:Â transformÂ 0.3s;  
    Â Â }  
      
    Â Â .canvasÂ {  
    Â Â Â Â width:Â 686px;  
    Â Â Â Â height:Â 360px;  
    Â Â Â Â overflow:Â hidden;  
    Â Â Â Â background:Â #fff;  
    Â Â }  
      
    Â Â &.full-screenÂ {  
    Â Â Â Â .signature-topÂ {  
    Â Â Â Â Â Â position:Â absolute;  
    Â Â Â Â Â Â width:Â calc(100vhÂ -Â 64px);  
    Â Â Â Â Â Â transform:Â translate(686px,Â 0)Â rotate(90deg);  
    Â Â Â Â }  
      
    Â Â Â Â .canvasÂ {  
    Â Â Â Â Â Â width:Â 630px;  
    Â Â Â Â Â Â height:Â 1386px;  
    Â Â Â Â }  
    Â Â }  
    }  
    

![](https://mmbiz.qpic.cn/sz_mmbiz_gif/TpB2QHJbiaicGYCJGZT4uj3E0IiaRMnAYkdibc6OzpMLvtH3eBn9IhNC4VLGllicEPdEibGyLVtJ3WnWs8JJKjftGuiaA/640?wx_fmt=gif&from=appmsg)
ç­¾å-6.gif

okï¼Œå¯ä»¥çœ‹åˆ°ï¼Œç­¾ååŠŸèƒ½åˆæ­£å¸¸äº†ã€‚ä½†æ˜¯ï¼Œåœ¨æˆ‘ä»¬ç‚¹å‡»æ¸…ç©ºçš„æ—¶å€™å‘ç°æ¸…ç©ºä¹Ÿåäº†ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬è°ƒç”¨çš„ ` clearRect `
æ˜¯æ¸…é™¤ç”»å¸ƒä¸Šåœ¨è¯¥çŸ©å½¢åŒºåŸŸå†…çš„å†…å®¹ï¼Œæ‰€ä»¥åŸæœ¬åœ¨åˆå§‹åŒ–è·å–çš„ ` Canvas ` å®½é«˜åœ¨æ¨ªå±çš„æ—¶å€™å®é™…ä¸Šå·²ç»å‘ç”Ÿäº†å˜åŒ–ï¼Œåªè¦åœ¨æ¨ªå±æ—¶é‡æ–°è·å–ä¸€æ¬¡ç»„ä»¶å®½é«˜å³å¯

    
    
    constÂ toggleSizeÂ =Â ()Â =>Â {  
    Â Â setFull(!full);  
    Â Â setTimeout(()Â =>Â {  
    Â Â Â Â getCanvasSize();  
    Â Â },Â 200);  
    };  
    

å¥½äº†ï¼Œåˆ°è¿™é‡Œå·²ç»èƒ½å¾—åˆ°ä¸€ä¸ªç›¸å¯¹å®Œæ•´çš„ç­¾åç‰ˆåŠŸèƒ½äº†

![](https://mmbiz.qpic.cn/sz_mmbiz_gif/TpB2QHJbiaicGYCJGZT4uj3E0IiaRMnAYkdqS2IxicHp2VwNEdCVBIRibMuDZAKZvTMwms1y6vGGIAM4IY1bKCBVOwA/640?wx_fmt=gif&from=appmsg)
ç­¾å-7.gif

##  æ€»ç»“

ä»¥ä¸Šå°±æ˜¯ç­¾åç‰ˆçš„å®ç°ï¼Œå®é™…ä¸ŠH5çš„å®ç°ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œåªæ˜¯æŸäº›éƒ¨åˆ†ä¼šå’Œå°ç¨‹åºæœ‰æ‰€åŒºåˆ«ã€‚æ•´ä¸ªç­¾åæ¿çš„å®ç°åŸºæœ¬ä¸Šå°±æ˜¯ä½¿ç”¨canvasï¼Œæ²¡æœ‰ç‰¹åˆ«å¤æ‚çš„ç‚¹ï¼Œä½†æ˜¯è¿‡ç¨‹ä¸­æ€»ä¼šé‡åˆ°å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜ï¼Œå½“ä½ ä¸€ä¸ªä¸€ä¸ªè§£å†³ä¹‹åï¼Œä½ ä¼šå‘ç°ï¼Œä»Šå¤©çš„å§¿åŠ¿åˆèƒ½+1ï¼Œè¿™ä¸å°±æ˜¯ç¨‹åºå‘˜çš„å¿«ä¹å—ã€‚æ„Ÿè°¢é˜…è¯»ã€‚

##  æœ€å

ğŸ“š å°èŒ—æ–‡ç« æ¨èï¼š

  * [ å°ç¨‹åºä¸»åŒ…ä½“ç§¯çš„ä¼˜åŒ–æ–¹æ¡ˆä¸æŠ€æœ¯å®ç° ](http://mp.weixin.qq.com/s?__biz=Mzg4OTkwMTY3Mg==&mid=2247485223&idx=1&sn=013a3cd62449303136a8e8556b688f3e&chksm=cfe58020f89209365a3a0620e7269b9ac7243cd7f793fc1802a863c3d40cb7b6bad462d05064&scene=21#wechat_redirect)   

  * [ JSPDF + html2canvas A4åˆ†é¡µæˆªæ–­ ](http://mp.weixin.qq.com/s?__biz=Mzg4OTkwMTY3Mg==&mid=2247485180&idx=1&sn=ea64ad64b9d0d1c2b3dbd08f59728ea1&chksm=cfe581fbf89208edc23bc7fe431b8196177a1444fb4a028f214d137ac3b6e4b9b36f05e785a4&scene=21#wechat_redirect)
  * [ Formily JSON Schema æ¸²æŸ“æµç¨‹åŠæ¡ˆä¾‹æµ…æ ](http://mp.weixin.qq.com/s?__biz=Mzg4OTkwMTY3Mg==&mid=2247485145&idx=1&sn=092946f0f6a3b4a2980d2437eff14ffb&chksm=cfe581def89208c836cb55093142f4ebfac19d116ad8328030c260bd81b0cce5c75eaf8389ed&scene=21#wechat_redirect)

  

  

é¢„è§ˆæ—¶æ ‡ç­¾ä¸å¯ç‚¹

å¾®ä¿¡æ‰«ä¸€æ‰«  
å…³æ³¨è¯¥å…¬ä¼—å·





****



****



Ã—  åˆ†æ

  æ”¶è—

